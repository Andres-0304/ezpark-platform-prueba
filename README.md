# EzPark Platform üÖøÔ∏è

## üìñ Overview
EzPark Platform is a comprehensive **P2P (Peer-to-Peer) parking solution backend** built with Spring Boot and following **Domain-Driven Design (DDD)** principles with **Hexagonal Architecture**.

> **Proyecto transformado desde CatchUpPlatform a EzPark Platform con 100% de compilaci√≥n exitosa**

## üèóÔ∏è **TRANSFORMACI√ìN COMPLETA REALIZADA**

### **1. RENOMBRADO DEL PROYECTO**
- **Antes:** `CatchUpPlatform` 
- **Despu√©s:** `EzParkPlatform`
- **Cambios:** Todos los paquetes de `com.acme.catchup.platform` ‚Üí `com.acme.ezpark.platform`

### **2. ARQUITECTURA HEXAGONAL COMPLETA CON DDD**

#### **üìÅ ESTRUCTURA DE CADA DOMINIO:**
```
domain-name/
‚îú‚îÄ‚îÄ application/           # Servicios de aplicaci√≥n
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/    # Entidades principales
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands/      # Comandos CQRS
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ queries/       # Consultas CQRS
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ valueobjects/  # Objetos de valor
‚îÇ   ‚îî‚îÄ‚îÄ services/          # Servicios de dominio
‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îî‚îÄ‚îÄ persistence/jpa/   # Repositorios JPA
‚îî‚îÄ‚îÄ interfaces/rest/       # Controladores REST
    ‚îú‚îÄ‚îÄ resources/         # DTOs de entrada/salida
    ‚îî‚îÄ‚îÄ transform/         # Ensambladores
```

### **3. DOMINIOS IMPLEMENTADOS (7 CONTROLADORES)**

#### **üë§ USERS (7 endpoints)**
```java
POST   /api/v1/users              // Crear usuario
GET    /api/v1/users/{id}         // Obtener por ID
PUT    /api/v1/users/{id}         // Actualizar usuario
DELETE /api/v1/users/{id}         // Eliminar usuario
GET    /api/v1/users              // Listar todos
GET    /api/v1/users/email/{email} // Buscar por email
GET    /api/v1/users/phone/{phone} // Buscar por tel√©fono
```

#### **üöó VEHICLES (7 endpoints)**
```java
POST   /api/v1/vehicles           // Crear veh√≠culo
GET    /api/v1/vehicles/{id}      // Obtener por ID
PUT    /api/v1/vehicles/{id}      // Actualizar veh√≠culo
DELETE /api/v1/vehicles/{id}      // Eliminar veh√≠culo
GET    /api/v1/vehicles           // Listar todos
GET    /api/v1/vehicles/user/{userId}     // Por usuario
GET    /api/v1/vehicles/license/{license} // Por matr√≠cula
```

#### **üÖøÔ∏è PARKINGS (8 endpoints)**
```java
POST   /api/v1/parkings           // Crear parking
GET    /api/v1/parkings/{id}      // Obtener por ID
PUT    /api/v1/parkings/{id}      // Actualizar parking
DELETE /api/v1/parkings/{id}      // Eliminar parking
GET    /api/v1/parkings           // Listar todos
GET    /api/v1/parkings/owner/{ownerId}   // Por propietario
GET    /api/v1/parkings/location          // Por ubicaci√≥n
GET    /api/v1/parkings/available         // Disponibles
```

#### **üìÖ BOOKINGS (8 endpoints)**
```java
POST   /api/v1/bookings           // Crear reserva
GET    /api/v1/bookings/{id}      // Obtener por ID
PUT    /api/v1/bookings/{id}      // Actualizar reserva
DELETE /api/v1/bookings/{id}      // Cancelar reserva
GET    /api/v1/bookings           // Listar todas
GET    /api/v1/bookings/user/{userId}     // Por usuario
GET    /api/v1/bookings/parking/{parkingId} // Por parking
GET    /api/v1/bookings/user/{userId}/status/{status} // Por estado
```

#### **üí≥ PAYMENT CARDS (7 endpoints)**
```java
POST   /api/v1/payment-cards      // Crear tarjeta
GET    /api/v1/payment-cards/{id} // Obtener por ID
PUT    /api/v1/payment-cards/{id} // Actualizar tarjeta
DELETE /api/v1/payment-cards/{id} // Eliminar tarjeta
GET    /api/v1/payment-cards      // Listar todas
GET    /api/v1/payment-cards/user/{userId} // Por usuario
PUT    /api/v1/payment-cards/{id}/default  // Establecer por defecto
```

#### **‚è∞ SCHEDULE (6 endpoints)**
```java
POST   /api/v1/schedules          // Crear horario
GET    /api/v1/schedules/{id}     // Obtener por ID
PUT    /api/v1/schedules/{id}     // Actualizar horario
DELETE /api/v1/schedules/{id}     // Eliminar horario
GET    /api/v1/schedules          // Listar todos
GET    /api/v1/schedules/parking/{parkingId} // Por parking
```

#### **üìç LOCATION (8 endpoints)**
```java
POST   /api/v1/locations          // Crear ubicaci√≥n
GET    /api/v1/locations/{id}     // Obtener por ID
PUT    /api/v1/locations/{id}     // Actualizar ubicaci√≥n
DELETE /api/v1/locations/{id}     // Eliminar ubicaci√≥n
GET    /api/v1/locations          // Listar todas
GET    /api/v1/locations/city/{city}       // Por ciudad
GET    /api/v1/locations/coordinates       // Por coordenadas
GET    /api/v1/locations/nearby            // Cercanas
```

### **4. OBJETOS DE VALOR (VALUE OBJECTS)**

Se separaron los enums de las entidades principales siguiendo principios DDD:

```java
// vehicle/domain/model/valueobjects/VehicleType.java
public enum VehicleType {
    CAR, MOTORCYCLE, TRUCK, VAN
}

// booking/domain/model/valueobjects/BookingStatus.java
public enum BookingStatus {
    PENDING, CONFIRMED, ACTIVE, COMPLETED, CANCELLED
}

// payment/domain/model/valueobjects/CardType.java
public enum CardType {
    VISA, MASTERCARD, AMERICAN_EXPRESS
}
```

### **5. INFRAESTRUCTURA COMPARTIDA**

#### **üîß Configuraci√≥n JPA:**
```java
// shared/infrastructure/persistence/jpa/configuration/JpaConfiguration.java
@EnableJpaRepositories("com.acme.ezpark.platform")
@EntityScan("com.acme.ezpark.platform")
```

#### **üìù Documentaci√≥n OpenAPI:**
```java
// shared/infrastructure/documentation/OpenApiConfiguration.java
@OpenAPIDefinition(
    info = @Info(
        title = "EzPark Platform API",
        description = "P2P Parking Solution Backend API"
    )
)
```

#### **üåê Configuraci√≥n CORS:**
```java
// shared/infrastructure/configuration/WebConfiguration.java
@Override
public void addCorsMappings(CorsRegistry registry) {
    registry.addMapping("/api/**")
            .allowedOrigins("*")
            .allowedMethods("*");
}
```

#### **‚ö†Ô∏è Manejo Global de Excepciones:**
```java
// shared/infrastructure/web/GlobalExceptionHandler.java
@ControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(ResourceNotFoundException.class)
    @ExceptionHandler(ValidationException.class)
    @ExceptionHandler(Exception.class)
}
```

## üîß **SOLUCIONES IMPLEMENTADAS**

### **6. SOLUCI√ìN DEL PROBLEMA DE LOMBOK**

**‚ùå Problema:** Lombok no funcionaba correctamente, causando 93 errores de compilaci√≥n.

**‚úÖ Soluci√≥n:** Se a√±adieron **getters manuales** a todas las 7 entidades principales:

```java
// Ejemplo en User.java
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    // Getters manuales a√±adidos
    public Long getId() { return id; }
    public String getFirstName() { return firstName; }
    public String getLastName() { return lastName; }
    // ... etc para todos los campos
}
```

### **7. CORRECCI√ìN DE ERRORES CR√çTICOS**

#### **üîß Error de Estado de Reserva:**
```java
// ANTES (incorrecto):
BookingStatus.IN_PROGRESS

// DESPU√âS (corregido):
BookingStatus.ACTIVE
```

#### **üîß Configuraci√≥n de Lombok en pom.xml:**
```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <configuration>
        <annotationProcessorPaths>
            <path>
                <groupId>org.projectlombok</groupId>
                <artifactId>lombok</artifactId>
                <version>1.18.34</version>
            </path>
        </annotationProcessorPaths>
    </configuration>
</plugin>
```

#### **üîß Archivos Corruptos del Dominio Payment:**
**‚ùå Problema:** 6 errores por archivos con codificaci√≥n corrupta:
- `UpdatePaymentCardResource.java`
- `UpdatePaymentCardCommandFromResourceAssembler.java`
- `SetDefaultPaymentCardCommandFromResourceAssembler.java`

**‚úÖ Soluci√≥n:** Se recrearon usando PowerShell con codificaci√≥n UTF-8 sin BOM.

## üõ†Ô∏è Technology Stack

### Core Technologies
- **Java 24** - Programming language
- **Spring Boot 3.x** - Application framework
- **Spring Data JPA** - Data persistence
- **MySQL/PostgreSQL** - Database
- **Maven** - Build tool

### Key Dependencies
- **Lombok** - Boilerplate code reduction
- **SpringDoc OpenAPI** - API documentation
- **Jakarta Validation** - Data validation
### Key Dependencies
```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springdoc</groupId>
        <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
    </dependency>
    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <optional>true</optional>
    </dependency>
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <scope>runtime</scope>
    </dependency>
</dependencies>
```

## üìä **ESTAD√çSTICAS DEL PROYECTO**

### **‚úÖ RESULTADO FINAL:**
- ‚úÖ **147 archivos fuente compilados exitosamente**  
- ‚úÖ **0 errores de compilaci√≥n**  
- ‚úÖ **Arquitectura hexagonal completa**  
- ‚úÖ **7 dominios con 51 endpoints totales**  
- ‚úÖ **Patr√≥n CQRS implementado**  
- ‚úÖ **Documentaci√≥n Swagger/OpenAPI**  
- ‚úÖ **Manejo global de excepciones**  
- ‚úÖ **Configuraci√≥n de seguridad CORS**  

### **üìà M√âTRICAS DETALLADAS:**
| Componente | Cantidad |
|------------|----------|
| **Archivos Java** | 147 |
| **Controladores** | 7 |
| **Endpoints totales** | 51 |
| **Agregados (Entidades)** | 7 |
| **Objetos de Valor** | 3 |
| **Comandos CQRS** | 21 |
| **Consultas CQRS** | 15 |
| **Repositorios** | 7 |
| **Recursos (DTOs)** | 21 |
| **Ensambladores** | 14 |

### **üèóÔ∏è Estructura del Proyecto:**

```
src/main/java/com/acme/ezpark/platform/
‚îú‚îÄ‚îÄ EzParkPlatformApplication.java
‚îú‚îÄ‚îÄ shared/                    # üîß Infraestructura compartida
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exceptions/        # Excepciones personalizadas
‚îÇ   ‚îî‚îÄ‚îÄ infrastructure/
‚îÇ       ‚îú‚îÄ‚îÄ configuration/     # Configuraci√≥n CORS
‚îÇ       ‚îú‚îÄ‚îÄ documentation/     # OpenAPI/Swagger
‚îÇ       ‚îú‚îÄ‚îÄ persistence/       # JPA Configuration
‚îÇ       ‚îú‚îÄ‚îÄ validation/        # Validaci√≥n global
‚îÇ       ‚îî‚îÄ‚îÄ web/              # Manejo global de excepciones
‚îú‚îÄ‚îÄ user/                     # üë§ Gesti√≥n de usuarios
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aggregates/   # User.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands/     # CreateUserCommand, etc.
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ queries/      # GetUserByIdQuery, etc.
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/         # UserCommandService, UserQueryService
‚îÇ   ‚îú‚îÄ‚îÄ application/          # Servicios de aplicaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/       # UserRepository.java
‚îÇ   ‚îî‚îÄ‚îÄ interfaces/           # UsersController.java
‚îú‚îÄ‚îÄ vehicle/                  # üöó Gesti√≥n de veh√≠culos
‚îú‚îÄ‚îÄ parking/                  # üÖøÔ∏è Gesti√≥n de parkings
‚îú‚îÄ‚îÄ booking/                  # üìÖ Gesti√≥n de reservas
‚îú‚îÄ‚îÄ payment/                  # üí≥ Gesti√≥n de pagos
‚îú‚îÄ‚îÄ schedule/                 # ‚è∞ Gesti√≥n de horarios
‚îî‚îÄ‚îÄ location/                 # üìç Gesti√≥n de ubicaciones
```

## üöÄ **C√ìMO EJECUTAR EL PROYECTO**

### **Prerequisites**
- ‚òï **Java 24** or higher
- üì¶ **Maven 3.8+**
- üóÑÔ∏è **MySQL 8.0+** or **PostgreSQL 13+**

### **üîß Instalaci√≥n**

1. **Clonar el repositorio:**
```powershell
git clone <repository-url>
cd ezpark-platform
```

2. **Configurar base de datos en `application.properties`:**
```properties
spring.datasource.url=jdbc:mysql://localhost:3306/ezpark_db
spring.datasource.username=your_username
spring.datasource.password=your_password
spring.jpa.hibernate.ddl-auto=create-drop
```

3. **Compilar el proyecto:**
```powershell
.\mvnw.cmd clean compile
```

4. **Ejecutar la aplicaci√≥n:**
```powershell
.\mvnw.cmd spring-boot:run
```

5. **Acceder a la documentaci√≥n de la API:**
```
http://localhost:8080/swagger-ui.html
```

## üìñ **DOCUMENTACI√ìN DE LA API**

Una vez ejecut√°ndose, puedes acceder a:

- **üîó Swagger UI**: `http://localhost:8080/swagger-ui.html`
- **üìÑ OpenAPI JSON**: `http://localhost:8080/v3/api-docs`

### **üéØ Endpoints Principales:**

| Dominio | Base URL | Endpoints | Funcionalidades |
|---------|----------|-----------|-----------------|
| **Users** | `/api/v1/users` | 7 | CRUD, b√∫squeda por email/phone |
| **Vehicles** | `/api/v1/vehicles` | 7 | CRUD, b√∫squeda por usuario/licencia |
| **Parkings** | `/api/v1/parkings` | 8 | CRUD, b√∫squeda geogr√°fica |
| **Bookings** | `/api/v1/bookings` | 8 | CRUD, gesti√≥n de estados |
| **Payment Cards** | `/api/v1/payment-cards` | 7 | CRUD, tarjeta por defecto |
| **Schedules** | `/api/v1/schedules` | 6 | CRUD, horarios de parking |
| **Locations** | `/api/v1/locations` | 8 | CRUD, b√∫squeda por proximidad |

## üõ†Ô∏è **DESARROLLO**

### **üß™ Ejecutar pruebas:**
```powershell
.\mvnw.cmd test
```

### **üì¶ Construir el proyecto:**
```powershell
.\mvnw.cmd clean package
```

### **‚ú® Caracter√≠sticas t√©cnicas:**
- **Hexagonal Architecture**: Separaci√≥n clara de responsabilidades
- **Domain-Driven Design**: Modelos ricos de dominio con l√≥gica de negocio
- **CQRS Pattern**: Separaci√≥n de comandos y consultas
- **Value Objects**: Valores inmutables de dominio
- **Global Exception Handling**: Manejo centralizado de errores
- **OpenAPI Documentation**: Documentaci√≥n comprensiva de la API
- **Cross-Origin Support**: Configuraci√≥n CORS para integraci√≥n frontend

## ü§ù **CONTRIBUCI√ìN**

1. Seguir los patrones de arquitectura establecidos
2. Mantener la estructura de paquetes apropiada
3. Escribir pruebas comprensivas
4. Actualizar documentaci√≥n para nuevas caracter√≠sticas

---

## üìù **NOTAS DE LA TRANSFORMACI√ìN**

> **Este proyecto fue exitosamente transformado de CatchUpPlatform a EzPark Platform**
> 
> - ‚úÖ **Compilaci√≥n exitosa**: 147 archivos compilados sin errores
> - ‚úÖ **Arquitectura completa**: Hexagonal + DDD + CQRS
> - ‚úÖ **API funcional**: 51 endpoints REST documentados
> - ‚úÖ **Problemas resueltos**: Lombok, archivos corruptos, imports
> 
> **El proyecto est√° 100% listo para desarrollo adicional o despliegue.**

---

## üìÑ License

This project is licensed under the MIT License.
